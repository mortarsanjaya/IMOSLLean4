Find the smallest real number $M$ such that, for any $a, b, c \in \R$,
\[ |ab(a^2 - b^2) + bc(b^2 - c^2) + ca(c^2 - a^2)| \leq M(a^2 + b^2 + c^2)^2. \tag{*}\label{2006a6-eq0} \]



\subsection*{Answer}

$\dfrac{9}{32} \sqrt{2}$.



\subsection*{Solution}

Official solution: \url{https://www.imo-official.org/problems/IMO2006SL.pdf}

We present the official solution with shortcuts, relying on some polynomial identities to prove inequalities.

Start by noting the two identities
\[ ab(a^2 - b^2) + bc(b^2 - c^2) + ca(c^2 - a^2) = (b - a)(c - b)(a - c)(a + b + c), \]
\[ (b - c)^2 + (c - a)^2 + (a - b)^2 + (a + b + c)^2 = 3(a^2 + b^2 + c^2), \]
    which implies that~\eqref{2006a6-eq0} is equivalent to $0 \leq M$ and
\[ (xyzs)^2 \leq (M/9)^2 (x^2 + y^2 + z^2 + s^2)^4, \tag{*}\label{2006a6-eq1} \]
    where $x = b - c$, $y = c - a$, $z = a - b$, and $s = a + b + c$.
In particular, $x + y + z = 0$.
The lower bound $M \geq \frac{9}{32} \sqrt{2}$ is obtained by taking $a = \sqrt{2}$, $b = \sqrt{2} - 3$, and $c = \sqrt{2} + 3$.
These corresponds to $x = -6$, $y = z = 3$, and $s = 3 \sqrt{2}$.

For the upper bound, first we use AM-GM of the form $3(r + t)^4 \geq 4^4 r^3 t$.
Thus we have
\[ (x^2 + y^2 + z^2 + s^2)^4 \geq \frac{4^4}{3^3} (x^2 + y^2 + z^2)^3 s^2. \]
Next, for any $x, y, z \in \R$ with $x + y + z = 0$, we prove that
\[ (x^2 + y^2 + z^2)^3 \geq 54 (xyz)^2. \]
Indeed, plugging $z = -(x + y)$ and rearranging leads to
\[ (x^2 + y^2 + z^2)^3 - 54 (xyz)^2 = 8(x^2 + y^2 + xy)^3 - 54 x^2 y^2 (x + y)^2 = 2 (x - y)^2 (x + 2y)^2 (2x + y)^2. \]
Combining all the estimates yield
\[ (x^2 + y^2 + z^2 + s^2)^4 \geq 2^9 (xyzs)^2 \iff (xyzs)^2 \leq \frac{1}{2^9} (x^2 + y^2 + z^2 + s^2)^4. \]
Thus $M/9 = 2^{-9/2} \iff M = \dfrac{9}{32} \sqrt{2}$ works, as desired.



\subsection*{Implementation details}

The only instance of square roots used in the solution is the existence of $\sqrt{2}$.
Instead of importing the \texttt{Real} API, we just add a typeclass that indicates the existence of $\sqrt{2}$ on a totally ordered semiring.
Then the above problem is generalized to any totally ordered field with $\sqrt{2}$.

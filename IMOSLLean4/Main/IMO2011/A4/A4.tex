Determine all pairs $(f, g)$ of functions $\N \to \N$ such that, for any $k \in \N$,
\[ f^{g(k) + 2}(k) + g^{f(k) + 1}(k) + g(k + 1) + 1 = f(k + 1). \]



\subsection*{Answer}

$(\id_{\N}, 0)$.



\subsection*{Solution}

Reference: \url{https://artofproblemsolving.com/community/c6h488536p19655187}

We follow the referenced solution in the AoPS thread for IMO 2011 A4 by the user \textbf{yayups} (see post \#8).
The third (final) lemma in this solution can be greatly simplified since the second lemma essentially says that $f$ is strictly increasing.

It suffices to show that $f$ is the identity map.
Indeed, then $g^{k + 1}(k) + g(k + 1) = 0$ for all $k \in \N$.
This implies $g(k + 1) = 0$ for all $k \in \N$, and plugging $k = 0$ yields $g(0) = 0$.
To show that $f$ is the identity map, we only make use of the following inequality:
\[ f^{g(k) + 2}(k) < f(k + 1). \tag{1}\label{2011a4-eq1} \]

We first prove that, for any $k, n \in \N$, $k \leq n$ implies $k \leq f(n)$.
To prove this, we use induction on $k$; the base case $k = 0$ is trivial.
Now suppose that, for some $k \in \N$, $k \leq n$ implies $k \leq f(n)$.
Then easy induction yields $k \leq f^m(n)$ for all $m \geq 0$ and $n \geq k$.
In particular,~\eqref{2011a4-eq1} yields $k < f(n + 1)$ for all $n \geq k$.
Thus $k + 1 \leq f(n)$ for all $n \geq k + 1$.

As an implication, we have $f(n) \geq n$ for all $n \in \N$.
Thus,~\eqref{2011a4-eq1} yields that $f$ is strictly increasing since $f(k) \leq f^{g(k) + 2}(k) < f(k + 1)$ for all $k \geq 0$.
Finally, since $f$ is strictly increasing,~\eqref{2011a4-eq1} yields that for any $k \in \N$,
\[ k \leq f(k) \leq f^{g(k) + 1}(k) < k + 1 \implies f(k) = k. \]



\subsection*{Extra notes}

The above version of the problem is the $\N$-version of the original problem.
We also implement the solution for the original problem.
